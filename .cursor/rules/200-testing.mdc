---
description: "Testing patterns and standards for Jest and Pytest"
globs: ["**/*.test.*", "**/*.spec.*", "**/tests/**/*", "**/__tests__/**/*", "**/test_*.py"]
---

# Testing Standards

## Test Frameworks

- **TypeScript/JavaScript:** Jest
- **Python:** Pytest

## Structure

```
src/utils/validator.ts
__tests__/utils/validator.test.ts

src/utils/validator.py
tests/utils/test_validator.py
```

## Test Pattern (Arrange-Act-Assert)

```typescript
describe('functionName', () => {
  it('should handle valid input', () => {
    // Arrange
    const input = 'valid';

    // Act
    const result = functionName(input);

    // Assert
    expect(result).toBe(expected);
  });

  it('should throw for invalid input', () => {
    // Negative test
    expect(() => functionName(null)).toThrow();
  });
});
```

```python
class TestFunctionName:
    def test_valid_input(self):
        # Arrange
        input_val = 'valid'

        # Act
        result = function_name(input_val)

        # Assert
        assert result == expected

    def test_invalid_input_raises(self):
        with pytest.raises(ValueError):
            function_name(None)
```

## Requirements

- At least one negative test per feature
- Test edge cases and boundaries
- Mock external dependencies
- Tests must be independent
- Use descriptive test names

## Async Testing Patterns

### Jest Async/Await
```typescript
it('should fetch user data', async () => {
  const user = await fetchUser(1);
  expect(user.name).toBeDefined();
});
```

### Jest Timers & Timeouts
```typescript
jest.useFakeTimers();

it('should debounce calls', () => {
  const fn = jest.fn();
  const debounced = debounce(fn, 100);

  debounced();
  debounced();

  jest.advanceTimersByTime(100);
  expect(fn).toHaveBeenCalledTimes(1);
});
```

### React Testing Library
```typescript
import { render, screen, waitFor } from '@testing-library/react';

it('should load data', async () => {
  render(<UserProfile id={1} />);

  await waitFor(() => {
    expect(screen.getByText('John')).toBeInTheDocument();
  });
});
```

### Pytest Async
```python
import pytest

@pytest.mark.asyncio
async def test_async_fetch():
    result = await fetch_data()
    assert result is not None
```

## Commands

```bash
npm run test    # JavaScript/TypeScript
pytest -q       # Python
```
